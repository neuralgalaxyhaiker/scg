---
title: 关于源码保护方案
created: '2021-03-18 01:29:33'

---

# 关于源码保护方案

项目使用webpack打包成一个单文件，如果是多入口的话，需要打包成多个（或者使用运行参数方式区分），此单文件发布后使用特定的加密方式进行加密。然后再写一个加载运行程序，此程序用来解密文件并加载到内存中，然后 node stdin 方式直接从内存中运行程序。

## 保护策略

 所有运行的程序均是采用加密方式，由于nodejs为解析性语言所以必须采用源码运行，但是这些源码在内存中进行的解密和运行。

## 打包方式

- 项目文件单独打包
    - 优点：
        - 启动程序功能具有专一性，不用针对多个项目单独编写。
        - 方便升级操作，只需要升级项目的运行文件即可。
    - 缺点：可以看到项目的加密运行文件，有被暴力破解的风险
- 项目文件打包到运行程序中
    此方案的优缺点和独立打包相反。



## 加密方式

- 对称加密方式。
    - 优点：加密解密无需交互，简单方便（私有化部署无网络环境情况下建议采用）
    - 缺点：存在加密方式泄露风险
- RSA非对称 颁发证书方式
    - 优点1：所有部署机器都存在单独的证书，此证书也可以看成运行证书，只运行在此机器上运行
    - 优点2：加密方式即使泄露，因为无证书也无法扩散。
    - 缺点： 次加密方式业务稍微复杂，并且对于每个私有化部署都要采取一个特定打包。



## 存在风险和问题：

+ node如果指定运行逻辑依然可以拿到源码。编写一个名字为 node 的程序，接收stdin即可。
    - 解决方式：环境限定，程序中使用的node必须为指定版本号，在启动程序中做sha1验证。
+ 服务端打包的时候不可以打入html,js,css等文件（暂未找到解决方案）
    - 直接放在程序目录和node_module相同的处理方式。且文件为源码

